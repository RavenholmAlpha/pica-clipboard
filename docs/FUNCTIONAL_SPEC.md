# PICAclip 产品功能规格说明书 (Functional Specification)

本文档详细描述 PICAclip 的所有功能特性、交互细节及业务逻辑，旨在作为开发实施的直接依据，并为用户手册提供核心素材。

## 1. 界面体系与交互 (Interface System & Interaction)

PICAclip 采用 **双窗口交互模式**，将高频操作与低频配置分离，以保证极致的轻量化体验。

### 1.1 主交互界面：智能悬浮窗 (The Floating Panel)
这是用户日常使用最高频的窗口，即“剪贴板历史列表”。

- **设计理念**: 极简、快速、无干扰 (Distraction-free)。
- **呼出方式**: 
    - 全局快捷键 `Ctrl + Shift + V`。
    - 鼠标中键单击托盘图标（可选配置）。
- **窗口样式**:
    - **尺寸**: 默认宽 360px，高 500px（可拖拽调整）。
    - **外观**: 无边框 (Frameless)，圆角设计 (Radius 8px-12px)。
    - **背景**: 采用 Windows 原生 **Mica** 或 **Acrylic** (亚克力) 模糊效果，融合系统主题。
    - **阴影**: 带有系统级阴影，增强悬浮感。
- **定位逻辑**:
    - **智能跟随**: 窗口默认出现在鼠标光标附近（例如光标右下方 10px）。
    - **边缘自适应**: 若鼠标靠近屏幕边缘，窗口自动调整位置以确保完整显示（如在屏幕底部时向上展开）。
- **交互行为**:
    - **失去焦点即隐藏**: 点击窗口外部任意区域，窗口立即消失。
    - **键盘接管**: 呼出瞬间自动获取焦点，支持全键盘操作。

### 1.2 系统设置窗口 (Settings Window)
用于管理偏好设置、规则和数据，属于低频操作界面。

- **呼出方式**:
    - 右键点击任务栏托盘图标 -> 选择“设置”。
    - 在主悬浮窗右上角点击“齿轮 ⚙️”图标。
- **窗口样式**:
    - **类型**: 标准 Windows 应用程序窗口（带标题栏、最小化/关闭按钮）。
    - **尺寸**: 默认 800px x 600px，居中显示。
    - **布局**: 左侧导航栏 + 右侧内容区的经典布局。
- **交互行为**:
    - 独立于主悬浮窗，不会自动隐藏。
    - 修改配置后即时生效（无需重启）。

### 1.3 任务栏托盘 (System Tray)
- **图标**: PICAclip Logo。
- **状态指示**:
    - 正常状态：Logo 原色。
    - 暂停监听：Logo 变灰或带暂停角标。
- **右键菜单 (Context Menu)**:
    - **显示历史**: 呼出主悬浮窗。
    - **暂停/恢复监听**: 临时停止记录剪贴板。
    - **清空历史**: 快速清除所有非置顶记录。
    - **设置**: 打开设置窗口。
    - **退出**: 完全关闭程序。

---

## 2. 核心模块：智能剪贴板历史 (Smart Clipboard History)

自动监听系统剪贴板变化，记录并管理历史数据。

### 2.1 数据捕获 (Capture)
- **支持类型**:
    1.  **纯文本 (Text)**: 记录文本内容，保留基本格式（换行符）。
    2.  **富文本 (RTF/HTML)**: 捕获时提取纯文本用于索引，若技术允许保留 HTML 格式用于原样粘贴；UI 列表仅展示纯文本预览。
    3.  **图片 (Image)**: 自动保存复制的位图数据为本地临时文件，列表中展示缩略图预览。
    4.  **文件路径 (Files)**: 复制文件时，记录文件的完整路径列表。
- **智能去重**: 连续复制相同内容时，不产生新记录，而是更新旧记录的时间戳将其前置。
- **隐私过滤**:
    - **应用黑名单**: 自动忽略来自特定应用（如 1Password, KeePass, 支付宝控件）的复制内容。
    - **特征过滤**: 可配置正则规则（如银行卡号、长串密钥）自动忽略或自动标记为脱敏。

### 2.2 历史管理 (Management)
- **置顶 (Pinning)**:
    - 用户可以将重要记录“置顶”。
    - **逻辑**: 置顶记录始终显示在列表的最顶部，不受新记录插入的影响。
    - **排序**: 多个置顶记录之间按置顶时间或手动顺序排列；非置顶记录按复制时间倒序排列。
    - **图标**: 置顶条目显示“图钉 📌”图标。
- **删除**: 单条删除、清空非置顶记录、清空所有记录。
- **过期清理**: 可设置保留时长（如 30 天）或数量限制（如 1000 条），超限自动清理旧数据（置顶记录不清理）。

### 2.3 标签系统 (Tagging System)
- **功能描述**: 允许用户给任意历史记录或便签打上一个或多个标签。
- **应用场景**:
    - 给某段代码打上 `#Code`。
    - 给某个地址打上 `#Work`。
    - 给稍后要用的内容打上 `#Todo`。
- **交互**:
    - 在列表项上右键 -> “编辑标签”。
    - 搜索框输入 `#` 自动列出已有标签供筛选。
- **视觉**: 列表项底部或右侧显示彩色标签胶囊。

### 2.4 全局搜索 (Global Search)
- **统一入口**: 界面顶部常驻搜索框。
- **搜索范围**: 同时搜索 **剪贴板历史内容**、**快捷短语标题/内容** 和 **标签名称**。
- **匹配模式**:
    - **模糊匹配**: 输入关键词（如 "address"），匹配内容中包含该词的记录。
    - **标签筛选**: 输入 "#" 开头，通过标签快速过滤（如 "#重要"）。
    - **类型筛选**: 输入 "type:image" 或 "type:file" 快速筛选特定类型。

---

## 3. 核心模块：快捷短语/便签 (Structured Snippets)

独立的常用语管理库，用于存储长期复用的内容。

### 3.1 分类管理
- **多级分类**: 左侧边栏提供分类导航（如“常用密码”、“代码片段”、“回复话术”）。
- **自定义**: 支持新建、重命名、删除分类，支持设置分类图标。

### 3.2 短语条目
- **字段**: 标题 (Title)、内容 (Content)、标签 (Tags)。
- **脱敏/密码模式**:
    - 针对敏感信息（如密码、API Key），可开启“脱敏模式”。
    - **列表展示**: 内容默认显示为 `******`。
    - **查看**: 点击“眼睛”图标可临时查看明文。
    - **粘贴**: 即使在脱敏状态下，粘贴出去的也是明文。

---

## 4. 辅助效率工具 (Efficiency Tools)

### 4.1 纯文本粘贴 (Paste as Plain Text)
- **场景**: 从网页复制带格式（字体、颜色、超链接）的文本到 Word 或邮件时，去除所有格式。
- **操作**: 选中记录后，按 `Shift + Enter`，软件将去除富文本格式，仅将纯文本写入剪贴板并模拟粘贴。

### 4.2 队列粘贴 (Queue Paste / Sequential Paste)
- **场景**: 需要填写一个包含多个字段的表单（姓名、电话、地址），可以先在一个源文件中依次复制这三项，然后在表单页依次粘贴。
- **流程**:
    1.  开启“队列模式”。
    2.  连续复制 A, B, C。
    3.  PICAclip 记录顺序：[A, B, C]。
    4.  在目标处按粘贴热键（第一次贴 A，第二次贴 B，第三次贴 C）。
    5.  队列为空后自动退出模式。

### 4.3 图片预览
- 鼠标悬停在图片类型的记录上时，展示放大版预览图，方便确认细节。

### 4.4 悬浮翻译 (Inline Translation)
- **功能**: 选中一段文本后，触发特定快捷键（或在 PICAclip 列表中选中项按快捷键），调用在线翻译 API。
- **展示**: 在鼠标附近弹出轻量级悬浮窗显示翻译结果。
- **场景**: 快速阅读外文文档或代码注释。

---

## 5. 设置选项详细设计 (Detailed Configuration)

通过独立的设置窗口进行管理，界面布局如下：

### 5.1 常规 (General)
- **启动**: 开机自启动 (Toggle)。
- **语言**: 界面语言切换 (English/简体中文)。
- **主题**: 跟随系统 / 浅色 / 深色。
- **更新**: 自动检查更新。

### 5.2 剪贴板 (Clipboard)
- **历史记录**:
    - 保留条数限制 (如 1000 条)。
    - 过期时间限制 (如 30 天)。
- **隐私**:
    - **忽略应用**: 列表管理，添加不需要记录剪贴板的程序名 (exe)。
    - **忽略格式**: 配置正则表达式，匹配的内容不记录。

### 5.3 快捷键 (Shortcuts)
- **主界面**: 设置呼出主悬浮窗的热键 (录制控件)。
- **粘贴**: 
    - 纯文本粘贴热键。
    - 队列粘贴模式开关热键。
    - 悬浮翻译热键。

### 5.4 账户与同步 (Account & Sync) - *Future*
- (预留) 登录账户，配置多端同步选项。

### 5.5 关于 (About)
- 版本信息。
- 官网/GitHub 链接。
- 检查更新按钮。
